#!/usr/bin/env node

/**
 *   .-.    _           .-----. _
 *   : :   :_;          `-. .-':_;
 *   : :   .-..-..-. .--. : :  .-.
 *   : :__ : :: `; :' '_.': :  : :
 *   :___.':_;`.__.'`.__.':_;  :_;
 *
 *   Appcelerator Titanium Live Reload Development Tool
 */

/**
 * Module dependencies.
 */

require('shelljs/global');

var program = require('commander')
  , spawn = require('win-spawn')
  , colors = require('colors');


console.log(' ');
console.log('\x1B[90m' + ' LiveTi, Titanium Live file runner, version 0.0.1'+ '\x1B[90m');
console.log('\x1B[90m' + ' Copyright (c) 2013, Appcelerator, Inc.  All Rights Reserved.\n'+ '\x1B[90m');
console.log('\x1B[36m' + ' Please report bugs to http://jira.appcelerator.org/\n'+ '\x1B[36m');

// usage

program
  .usage('<command> [options]');

// sub-command help

program.on('--help', function(){
  console.log();
  console.log(' LiveTi - Titanium Live Reload Development Tool'.bold);
  console.log();
  console.log(' run       build an run your app in live mode');
  console.log();
  exec('ti build --help');
  process.exit();
});

// parse argv

program.parse(process.argv);

// args void of cmd

var args = process.argv.slice(3);

// command

var cmd = program.args[0];

// executable

var bin = 'liveti-' + (cmd || 'run');

// spawn

var proc = spawn(bin, args, { stdio: 'inherit', customFds: [0, 1, 2] });