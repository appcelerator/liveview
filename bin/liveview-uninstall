#!/usr/bin/env node
'use strict';
const program = require('commander'),
	chalk = require('chalk'),
	path = require('path'),
	execSync = require('child_process').execSync,
	{ green, red } = chalk;
/**
 * no-op on unknown options handling
 */
program.Command.prototype.unknownOption = function () {};

// usage
program.usage('uninstall');

// examples
program.on('--help', function () {
	console.log('  Examples:');
	console.log();
	console.log('    # remove cli hook');
	console.log('    $ liveview uninstall');
	console.log();
});

// parse argv
program.parse(process.argv);

// package
if (!process.env.APPC_NPM_VERSION) {
	const hook = path.join(__dirname, '../hook').replace(/\s/g, '\\ ');
	try {
		execSync('liveview server stop --no-banner', { stdio: 'ignore' });
		execSync('titanium -q config paths.hooks -r ' + hook);
		console.log(` Titanium CLI Hook ${green('removed')}\n`);
	} catch (e) {
		console.log(` Titanium CLI Hook ${red('not removed')}\n`);
	}
}
